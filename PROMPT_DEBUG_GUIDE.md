# 🐛 프롬프트 디버깅 가이드

대화 스타일 선택에 따른 프롬프트가 제대로 적용되는지 확인하는 방법입니다.

## 📋 디버깅 방법

### 1. UI 디버그 패널 사용 (가장 쉽습니다!)

1. 메인 페이지 하단 오른쪽에 있는 **🐛 버튼** 클릭
2. 디버그 패널이 열리면 다음 정보 확인:
   - **현재 선택된 스타일**: 선택한 대화 스타일과 ID
   - **적용될 프롬프트**: 실제로 사용될 프롬프트 전체 내용
   - **프롬프트 길이**: 문자 수
3. "콘솔에 출력" 버튼으로 콘솔에서도 확인 가능

### 2. 브라우저 콘솔 로그 확인

#### 연결 시작 시
```
🔌 Realtime 연결 시작
선택된 대화 스타일: businessBrainstorming (또는 null)
```

#### 프롬프트 적용 시
```
🎨 대화 스타일 프롬프트 적용
  선택된 스타일 ID: businessBrainstorming
  적용된 프롬프트: [프롬프트 전체 내용]
  프롬프트 길이: 1234 자
```

#### WebSocket 메시지 전송
```
📤 WebSocket 메시지 전송: {
  "type": "session.update",
  "session": {
    "type": "realtime",
    "instructions": "[프롬프트 내용]",
    ...
  }
}
```

#### WebSocket 응답 확인
```
📥 WebSocket 응답 (세션 업데이트): {
  "type": "session.updated",
  ...
}
✅ 적용된 프롬프트 확인: [프롬프트 앞부분 100자]...
```

### 3. 네트워크 탭에서 WebSocket 메시지 확인

1. 브라우저 개발자 도구 열기 (F12)
2. **Network** 탭 클릭
3. **WS** (WebSocket) 필터 선택
4. `realtime` 연결 찾기
5. 연결 클릭 → **Messages** 탭 확인
6. 다음 메시지 확인:
   - **전송된 메시지** (→): `session.update` 타입의 메시지에서 `instructions` 필드 확인
   - **수신된 메시지** (←): `session.updated` 타입의 메시지에서 `session.instructions` 확인

### 4. 실제 대화 응답으로 확인

각 스타일별로 AI의 응답 방식이 달라야 합니다:

- **업무 브레인스토밍** 💼: 전문적이고 구조화된 답변
- **일상 대화** ☕: 친근하고 자연스러운 대화
- **재밌는 이야기** 🎭: 유머러스하고 재미있는 응답
- **고민 상담** 🤗: 공감적이고 지지적인 응답
- **기본** ✨: 일반적인 친절한 응답

## 🔍 문제 해결

### 프롬프트가 적용되지 않는 경우

1. **콘솔에서 스타일 ID 확인**
   - 연결 시점의 스타일 ID가 올바른지 확인
   - `null`이면 기본 프롬프트 사용

2. **WebSocket 메시지 확인**
   - `session.update` 메시지에 `instructions` 필드가 있는지 확인
   - 프롬프트 내용이 올바른지 확인

3. **연결 후 스타일 변경**
   - 연결 후에는 스타일 변경이 불가능합니다
   - 연결을 종료한 후 스타일을 변경하고 다시 연결해야 합니다

### 프롬프트가 잘못 적용되는 경우

1. **스타일 ID 확인**
   - `conversationStyles.js`의 스타일 ID와 선택된 ID가 일치하는지 확인

2. **프롬프트 내용 확인**
   - 디버그 패널에서 실제 프롬프트 내용 확인
   - `getPromptForStyle` 함수가 올바른 프롬프트를 반환하는지 확인

## 📝 주요 확인 포인트

- ✅ 스타일 선택 시 스토어 업데이트 확인
- ✅ 연결 시작 시 선택된 스타일 ID 확인
- ✅ WebSocket 메시지의 `instructions` 필드 확인
- ✅ 세션 업데이트 응답 확인
- ✅ 실제 AI 응답이 선택한 스타일에 맞는지 확인

## 🎯 빠른 확인 체크리스트

- [ ] 디버그 패널에서 현재 프롬프트 확인
- [ ] 콘솔 로그에서 스타일 ID 확인
- [ ] WebSocket 메시지에서 `instructions` 확인
- [ ] 실제 대화 응답이 스타일에 맞는지 확인

